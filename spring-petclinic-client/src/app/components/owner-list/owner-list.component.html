<div class="row">
  <div class="col-12">
    <h2>Owners</h2>

    <!-- Search Form -->
    <form class="mb-4" style="max-width: 20em;" (ngSubmit)="onSearchChange()">
      <div class="mb-3">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Search Filter" 
          [(ngModel)]="searchQuery"
          (input)="onSearchChange()"
        />
      </div>
    </form>

    <!-- Loading State -->
    <div *ngIf="loading" class="text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="alert alert-danger" role="alert">
      {{ error }}
      <button type="button" class="btn btn-sm btn-outline-danger ms-2" (click)="loadOwners()">
        Retry
      </button>
    </div>

    <!-- Owners Table -->
    <div *ngIf="!loading && !error" class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th class="d-none d-md-table-cell">Address</th>
            <th>City</th>
            <th>Telephone</th>
            <th class="d-none d-sm-table-cell">Pets</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let owner of filteredOwners; trackBy: trackByOwner">
            <td>
              <a [routerLink]="['/owners', owner.id]" class="text-decoration-none">
                {{ owner.firstName }} {{ owner.lastName }}
              </a>
            </td>
            <td class="d-none d-md-table-cell">{{ owner.address }}</td>
            <td>{{ owner.city }}</td>
            <td>{{ owner.telephone }}</td>
            <td class="d-none d-sm-table-cell">
              <span *ngFor="let pet of owner.pets; let last = last">
                {{ pet.name }}<span *ngIf="!last"> </span>
              </span>
            </td>
          </tr>
          <tr *ngIf="filteredOwners.length === 0">
            <td colspan="5" class="text-center text-muted">
              <div class="py-4">
                <i class="bi bi-search fs-1"></i>
                <p class="mt-2">No owners found matching your search criteria.</p>
                <a routerLink="/owners/new" class="btn btn-primary">
                  <i class="bi bi-plus-circle"></i> Register New Owner
                </a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Add New Owner Button -->
    <div *ngIf="!loading && !error && filteredOwners.length > 0" class="mt-3">
      <a routerLink="/owners/new" class="btn btn-success">
        <i class="bi bi-plus-circle"></i> Register New Owner
      </a>
    </div>
  </div>
</div>
